{{ define "title" }}{{ .Title }} - {{ .Site.Title }}{{ end }}

{{ define "main" }}
<div class="container">
    <article class="single-post">
        <!-- Post Header -->
        <header class="single-post-header">
            <div class="single-post-meta">
                <img src="{{ .Site.Params.avatar }}" alt="{{ .Site.Params.author }}" class="single-post-avatar">
                <div class="single-post-author-info">
                    <h2>{{ .Site.Params.author }}</h2>
                    <time class="single-post-date" datetime="{{ .Date.Format "2006-01-02" }}">
                        {{ .Date.Format "2006年01月02日" }}
                    </time>
                </div>
            </div>
            
            <h1 class="single-post-title">{{ .Title }}</h1>
            
            <!-- Tags and Categories -->
            {{ if or .Params.tags .Params.categories }}
            <div class="post-tags">
                {{ range .Params.tags }}
                <a href="/tags/{{ . | urlize }}" class="tag">#{{ . }}</a>
                {{ end }}
                {{ range .Params.categories }}
                <a href="/categories/{{ . | urlize }}" class="tag">📁 {{ . }}</a>
                {{ end }}
            </div>
            {{ end }}
        </header>
        
        <!-- Featured Image -->
        {{ if .Params.cover }}
        <img src="{{ .Params.cover }}" alt="{{ .Title }}" class="single-post-image">
        {{ end }}
        
        <!-- Post Content -->
        <div class="single-post-content">
            {{ .Content }}
        </div>
        
        <!-- Post Footer -->
        <footer style="padding: 24px; border-top: 1px solid var(--ig-border);">
            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 16px;">
                <!-- Share Buttons -->
                <div style="display: flex; gap: 12px;">
                    <span style="color: var(--ig-gray); font-size: 14px;">分享:</span>
                    <a href="https://twitter.com/intent/tweet?text={{ .Title }}&url={{ .Permalink }}" 
                       target="_blank" rel="noopener" class="social-link" style="width: 36px; height: 36px;">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M23 3a10.9 10.9 0 01-3.14 1.53 4.48 4.48 0 00-7.86 3v1A10.66 10.66 0 013 4s-4 9 5 13a11.64 11.64 0 01-7 2c9 5 20 0 20-11.5a4.5 4.5 0 00-.08-.83A7.72 7.72 0 0023 3z"></path>
                        </svg>
                    </a>
                    <a href="https://www.facebook.com/sharer/sharer.php?u={{ .Permalink }}" 
                       target="_blank" rel="noopener" class="social-link" style="width: 36px; height: 36px;">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"></path>
                        </svg>
                    </a>
                </div>
                
                <!-- Reading Time -->
                <div style="color: var(--ig-gray); font-size: 14px;">
                    📖 阅读时长约 {{ div (countwords .Content) 200 }} 分钟
                </div>
            </div>
        </footer>
    </article>
    
    <!-- Navigation to Previous/Next Posts -->
    <div style="display: flex; justify-content: space-between; margin-top: 32px; gap: 16px;">
        {{ with .PrevInSection }}
        <a href="{{ .Permalink }}" class="btn btn-secondary" style="flex: 1; max-width: 300px;">
            ← {{ .Title }}
        </a>
        {{ else }}
        <div style="flex: 1;"></div>
        {{ end }}
        
        {{ with .NextInSection }}
        <a href="{{ .Permalink }}" class="btn btn-secondary" style="flex: 1; max-width: 300px; text-align: right;">
            {{ .Title }} →
        </a>
        {{ else }}
        <div style="flex: 1;"></div>
        {{ end }}
    </div>
    
    <!-- Related Posts -->
    {{ $related := .Site.RegularPages.Related . | first 3 }}
    {{ if $related }}
    <div style="margin-top: 60px;">
        <h2 style="font-size: 24px; font-weight: 700; margin-bottom: 24px; text-align: center;">
            相关文章
        </h2>
        <div class="posts-grid" style="grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));">
            {{ range $related }}
            <article class="post-card">
                <a href="{{ .Permalink }}">
                    <div class="post-image">
                        {{ if .Params.cover }}
                        <img src="{{ .Params.cover }}" alt="{{ .Title }}">
                        {{ else }}
                        <img src="/images/default-cover.jpg" alt="{{ .Title }}">
                        {{ end }}
                    </div>
                    <div class="post-info">
                        <h3 class="post-title">{{ .Title }}</h3>
                        <p class="post-date">{{ .Date.Format "2006-01-02" }}</p>
                    </div>
                </a>
            </article>
            {{ end }}
        </div>
    </div>
    {{ end }}
</div>
{{ end }}

